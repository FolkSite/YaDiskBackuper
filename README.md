# YaDiskBackuper

Резервное копирование сайтов в Яндекс Диск.

### Возможности
* Умеет удалять старые бекапы с ЯДиска, если они старее чем N дней (настраивается в config.yaml)
* Умеет удалять старые логи с сервера
* Раскладывает бекапы на ЯДиске по папкам вида: ГГГГ-ММ-ДД
* Бекапит системные папки: /etc/, /var/log/, /root/

### Примечание
Сервер должен быть настроен по [этой инструкции](https://modx.pro/hosting/678-the-right-hosting-for-modx-revolution-2/ "Правильный хостинг для MODX Revolution"):
* На каждый сайт создаётся свой пользователь в системе (1 сайт = 1 пользователь)
* Все сайты-пользователи располагаются в /var/www/
* Имя пользователя сайта, название и имя пользователя БД одинаковые

### Инструкция по установке в Linux Ubuntu, Debian и т.п.

1. Устанавливаем менеджер пакетов для Python 3:
    > apt-get install python3-pip

2. Устанавливаем зависимости для скрипта:
    > pip3 install requests

    > pip3 install pyyaml

3. Закидываем папку с бекапером куда-нибудь на сервер, например в /root/scripts/py/

4. Настраиваем config.yaml

5. Вызываем `sudo crontab -e` и прописываем ежедневный запуск в 2 часа ночи:
    > 0 2 * * * /usr/bin/env python3 /root/scripts/py/YaDiskBackuper/backuper.py